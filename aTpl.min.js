!function(name,fun){"undefined"!=typeof module&&module.exports?module.exports=fun():"function"==typeof define&&define.amd?define(fun):this[name]=fun()}("aTpl",function(){"use strict";var aTpl={version:"1.0.0",open:"{{",close:"}}",config:function(options){return this.open=options.open||"{{",this.close=options.close||"}}",this},exper:function(str){return new RegExp(str,"g")},seperate:function(t,_,__){var tmp=["@([\\s\\S])+?","([^{@}])*?"][t||0];return this.exper((_||"")+this.open+tmp+this.close+(__||""))},escape:function(html){return String(html||"").replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")},error:function(e){return"undefined"!=typeof console&&"undefined"!=typeof console.error&&console.error(e),e},parser:function(tpl,data){var _this=this,open=_this.exper("^"+_this.open+"@",""),end=_this.exper(_this.close+"$","");tpl=tpl.replace(/[\r\t\n]/g," ").replace(_this.exper(_this.open+"@"),_this.open+"@ ").replace(_this.exper(_this.close+"}"),"} "+_this.close).replace(/\\/g,"\\\\").replace(/(?="|')/g,"\\").replace(_this.seperate(),function(str){return str=str.replace(open,"").replace(end,""),'";'+str.replace(/\\/g,"")+'; _v+="'}).replace(_this.seperate(1),function(str){var open='"+(';return str.replace(/\s/g,"")===_this.open+_this.close?"":(str=str.replace(_this.exper(_this.open+"|"+_this.close),""),/^=/.test(str)&&(str=str.replace(/^=/,""),open='"+_escape_('),open+str.replace(/\\/g,"")+')+"')}),tpl='"use strict";var _v = "'+tpl+'";return _v;';try{return _this.cache=tpl=new Function("aTpl, _escape_",tpl),tpl(data,_this.escape)}catch(e){return delete _this.cache,_this.error(e+_this.tpl)}},template:function(tpl){return tpl=tpl[0]||tpl,"text/aTpl"!==tpl.type?this:(this.tpl=tpl.innerHTML,this)},render:function(data,cb){"function"==typeof data&&(data=data());var tpl,_this=this;return data?this.tpl?(tpl=_this.cache?_this.cache(data,_this.escape):_this.parser(_this.tpl,data),cb?void cb(tpl):tpl):_this.error("no template"):_this.error("no data")}};return aTpl});